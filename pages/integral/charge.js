(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/integral/charge"],{3378:function(e,t,n){"use strict";(function(e){n("ec1d");a(n("66fd"));var t=a(n("aaf5"));function a(e){return e&&e.__esModule?e:{default:e}}wx.__webpack_require_UNI_MP_PLUGIN__=n,e(t.default)}).call(this,n("a821")["createPage"])},8004:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return a}));var a={uNavbar:function(){return n.e("uview-ui/components/u-navbar/u-navbar").then(n.bind(null,"a57e"))}},r=function(){var e=this,t=e.$createElement;e._self._c},i=[]},"81a0":function(e,t,n){"use strict";(function(e,a){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(n("a34a"));function i(e){return e&&e.__esModule?e:{default:e}}function u(e,t,n,a,r,i,u){try{var c=e[i](u),s=c.value}catch(o){return void n(o)}c.done?t(s):Promise.resolve(s).then(a,r)}function c(e){return function(){var t=this,n=arguments;return new Promise((function(a,r){var i=e.apply(t,n);function c(e){u(i,a,r,c,s,"next",e)}function s(e){u(i,a,r,c,s,"throw",e)}c(void 0)}))}}var s={data:function(){return{userIntegral:0,payPrice:0,payIntegral:0,chargeList:[{price:.1,integral:2,give:0},{price:30,integral:300,give:30},{price:50,integral:500,give:50},{price:100,integral:1e3,give:100},{price:300,integral:3e3,give:300},{price:500,integral:5e3,give:500}]}},onLoad:function(){this.payPrice=this.chargeList[0].price,this.payIntegral=this.chargeList[0].integral},methods:{getUser:function(){var t=this;return c(r.default.mark((function n(){var a,i;return r.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return a=t,n.next=3,e.callFunction({name:"query_map",data:{dbName:"wx_user",id:a.vuex_user._id}});case 3:i=n.sent,a.$u.vuex("vuex_user",i.result);case 5:case"end":return n.stop()}}),n)})))()},payClick:function(e,t){this.payPrice=e,this.payIntegral=t},payit:function(){var t=this;return c(r.default.mark((function n(){var i,u,s,o;return r.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(i=t,i.payPrice&&i.payIntegral){n.next=4;break}return a.showToast({icon:"none",mask:!0,title:"支付信息不完整",duration:1e3}),n.abrupt("return");case 4:return a.showLoading({mask:!0,title:"正在拼命加载中..."}),u={total_fee:100*i.payPrice,open_id:i.vuex_user.openid,body:"心妍壁纸库-充值"+i.payIntegral+"积分"},n.next=8,e.callFunction({name:"payment",data:u});case 8:s=n.sent,s.result.data.package&&(o=s.result.data,a.requestPayment({timeStamp:o.timeStamp,nonceStr:o.nonceStr,package:o.package,signType:o.signType,paySign:o.paySign,success:function(){var t=c(r.default.mark((function t(n){var u;return r.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a.showLoading({mask:!0,title:"正在充值..."}),t.next=3,e.callFunction({name:"charge_add",data:{integral:i.payIntegral,userId:i.vuex_user._id}});case 3:u=t.sent,u.result.success&&i.getUser(),a.showToast({icon:"none",mask:!0,title:u.result.msg,duration:1e3});case 6:case"end":return t.stop()}}),t)})));function n(e){return t.apply(this,arguments)}return n}(),fail:function(e){var t="充值失败";"requestPayment:fail cancel"===e&&(t="取消支付"),a.showToast({icon:"none",title:t})}})),a.hideLoading();case 11:case"end":return n.stop()}}),n)})))()}}};t.default=s}).call(this,n("a9ff")["default"],n("a821")["default"])},"8efc":function(e,t,n){"use strict";var a=n("bd2e"),r=n.n(a);r.a},aaf5:function(e,t,n){"use strict";n.r(t);var a=n("8004"),r=n("bb39");for(var i in r)"default"!==i&&function(e){n.d(t,e,(function(){return r[e]}))}(i);n("8efc");var u,c=n("f0c5"),s=Object(c["a"])(r["default"],a["b"],a["c"],!1,null,null,null,!1,a["a"],u);t["default"]=s.exports},bb39:function(e,t,n){"use strict";n.r(t);var a=n("81a0"),r=n.n(a);for(var i in a)"default"!==i&&function(e){n.d(t,e,(function(){return a[e]}))}(i);t["default"]=r.a},bd2e:function(e,t,n){}},[["3378","common/runtime","common/vendor"]]]);